from os import listdir

path = raw_input("Path: ")
workID = path.split('/')[7]
print workID

fileList = listdir(path)

for eachFile in fileList:
  inFile = open(path + '/' + eachFile)
  rawText = inFile.read()
  lines = rawText.split('\n')
  inFile.close()

  revisedFile = ""

  for line in lines:
    # Fix title line
    if "Title:" in line:
      segments = line.split(' ')

      # Figure out correct extension
      if ".png" in segments[1]:
        extension = "png"
        # Keeps numbers and extension
        end = segments[1].split('b-')[1]
        end = end[5:9] + end[-4:]
      elif ".tiff" in segments[1]:
        extension = "tif"
        end = segments[1].split('b-')[1]
        end = end[5:9] + end[-5:]
      elif ".tif" in segments[1]:
        extension = "tif"
        end = segments[1].split('b-')[1]
        end = end[5:9] + end[-4:]
      elif ".jpg" in segments[1]:
        extension = "jpg"
        end = segments[1].split('b-')[1]
        end = end[5:9] + end[-4:]
      else:
        extension = "ERROR"
        print extension

      print extension

      # Pad with zeros if necessary
      if len(end.split('.')[0]) == 1:
        end = str("000") + end
      elif len(end.split('.')[0]) == 2:
        end = str("00") + end
      elif len(end.split('.')[0]) == 3:
        end = str("0") + end
      elif len(end.split('.')[0]) == 4:
        pass
      else:
        extension = "ERROR"
        print("Padding error!")

      # Revise line
      if extension != "ERROR":
        segments[1] = workID + '_' + end
        fileName = segments[1]
        line = segments[0] + ' ' + segments[1]
        revisedFile = revisedFile + line + '\n'

    elif "Path:" in line:
      # Revise line
      line = "Path: /home/chris/Github/x_eu-images/full/" + workID + '/' + extension + '/' + fileName
      revisedFile = revisedFile + line + '\n'

    else:
      revisedFile = revisedFile + line + '\n'

  revisedFile = revisedFile[:-1]
  print revisedFile
  
  # Save file
  outFile = open(path + '/' + eachFile, 'w')
  outFile.write(revisedFile)
  print revisedFile
  outFile.close()

