from gamera.core import *
init_gamera()
from gamera.plugins import binarization
import sys
from os import listdir

path = sys.argv[-1]

fileList = listdir(path)

for f in fileList:
  if ".png" in f:
    img = load_image(path + "/" + f)
    if img.data.pixel_type != ONEBIT:
      img = img.sauvola_threshold()
    img.save_PNG(path[:-4] + "/bi/" + f)

  elif ".tiff" in f:
    stem = f[:-5]
    img = load_image(path + "/" + f)
    if img.data.pixel_type != ONEBIT:
      img = img.sauvola_threshold()
    img.save_PNG(path[:-4] + "/bi/" + stem + ".png")

  elif ".tif" in f:
    stem = f[:-4]
    img = load_image(path + "/" + f)
    if img.data.pixel_type != ONEBIT:
      img = sauvola_threshold()
    img.save_PNG(path[:-4] + "/bi/" + stem + ".png")
